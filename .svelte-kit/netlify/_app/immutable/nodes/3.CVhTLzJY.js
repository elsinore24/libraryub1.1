import{M as Ie,_ as fe,$ as ce,s as W,n as P,d as _,a0 as ue,i as B,b as g,l as v,c as w,e as T,g as L,h as D,j as H,a1 as je,A as Ve,a as Te,y as u,r as Y,m as R,f as qe,t as $e,N as F,z as Le,o as Ce,a2 as Ae}from"../chunks/DQIBoYTc.js";import{n as Be,l as Pe,S as x,i as ee,a as q,f as N,d as U,t as A,c as te,m as G,e as K,b as J,g as le,h as Oe}from"../chunks/DM8dauRH.js";import{e as ne,u as He,d as Se,a as Xe}from"../chunks/P8xsQ0fg.js";import{w as Ye}from"../chunks/BRiskQ2-.js";import{S as O}from"../chunks/lBltZnr1.js";const Ze=!1,bt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Ze},Symbol.toStringTag,{value:"Module"}));function re(i){const e=i-1;return e*e*e+1}function Q(i,{delay:e=0,duration:t=400,easing:l=Ie}={}){const s=+getComputedStyle(i).opacity;return{delay:e,duration:t,easing:l,css:a=>`opacity: ${a*s}`}}function oe(i,{delay:e=0,duration:t=400,easing:l=re,x:s=0,y:a=0,opacity:n=0}={}){const o=getComputedStyle(i),r=+o.opacity,f=o.transform==="none"?"":o.transform,c=r*(1-n),[b,k]=fe(s),[h,m]=fe(a);return{delay:e,duration:t,easing:l,css:(E,$)=>`
			transform: ${f} translate(${(1-E)*b}${k}, ${(1-E)*h}${m});
			opacity: ${r-c*$}`}}function de(i){return Object.prototype.toString.call(i)==="[object Date]"}function ie(i,e){if(i===e||i!==i)return()=>i;const t=typeof i;if(t!==typeof e||Array.isArray(i)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(i)){const l=e.map((s,a)=>ie(i[a],s));return s=>l.map(a=>a(s))}if(t==="object"){if(!i||!e)throw new Error("Object cannot be null");if(de(i)&&de(e)){i=i.getTime(),e=e.getTime();const a=e-i;return n=>new Date(i+n*a)}const l=Object.keys(e),s={};return l.forEach(a=>{s[a]=ie(i[a],e[a])}),a=>{const n={};return l.forEach(o=>{n[o]=s[o](a)}),n}}if(t==="number"){const l=e-i;return s=>i+s*l}throw new Error(`Cannot interpolate ${t} values`)}function Re(i,e={}){const t=Ye(i);let l,s=i;function a(n,o){if(i==null)return t.set(i=n),Promise.resolve();s=n;let r=l,f=!1,{delay:c=0,duration:b=400,easing:k=Ie,interpolate:h=ie}=ce(ce({},e),o);if(b===0)return r&&(r.abort(),r=null),t.set(i=s),Promise.resolve();const m=Be()+c;let E;return l=Pe($=>{if($<m)return!0;f||(E=h(i,n),typeof b=="function"&&(b=b(i,n)),f=!0),r&&(r.abort(),r=null);const S=$-m;return S>b?(t.set(i=n),!1):(t.set(i=E(k(S/b))),!0)}),l.promise}return{set:a,update:(n,o)=>a(n(s,i),o),subscribe:t.subscribe}}function he(i,e,t){const l=i.slice();return l[19]=e[t],l}function ve(i,e){let t,l,s='<div class="spine-line svelte-lty0mq"></div>',a,n,o,r=e[19].title+"",f,c,b,k,h,m,E,$,S;function C(...d){return e[9](e[19],...d)}function V(...d){return e[10](e[19],...d)}function I(...d){return e[11](e[19],...d)}function p(...d){return e[12](e[19],...d)}return{key:i,first:null,c(){t=D("div"),l=D("div"),l.innerHTML=s,a=H(),n=D("div"),o=D("span"),f=$e(r),c=H(),b=D("div"),k=H(),this.h()},l(d){t=w(d,"DIV",{class:!0,style:!0,draggable:!0,role:!0,"aria-label":!0,"aria-grabbed":!0});var y=T(t);l=w(y,"DIV",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-xq6ivu"&&(l.innerHTML=s),a=L(y),n=w(y,"DIV",{class:!0});var z=T(n);o=w(z,"SPAN",{class:!0});var M=T(o);f=qe(M,r),M.forEach(_),z.forEach(_),c=L(y),b=w(y,"DIV",{class:!0}),T(b).forEach(_),k=L(y),y.forEach(_),this.h()},h(){v(l,"class","book-spine svelte-lty0mq"),v(o,"class","book-title svelte-lty0mq"),v(n,"class","book-content svelte-lty0mq"),v(b,"class","book-edge svelte-lty0mq"),v(t,"class","book-item svelte-lty0mq"),u(t,"--book-color",e[19].color),u(t,"--book-dark",ge(e[19].color)),u(t,"--text-color",se(e[19].color).l>50?"#000":"#fff"),v(t,"draggable",h=!e[1]),v(t,"role",Ne),v(t,"aria-label",m=`${pe}: ${e[19].title}`),v(t,"aria-grabbed",E=!e[1]),this.first=t},m(d,y){B(d,t,y),g(t,l),g(t,a),g(t,n),g(n,o),g(o,f),g(t,c),g(t,b),g(t,k),$||(S=[Y(t,"dragstart",C),Y(t,"dragend",e[4]),Y(t,"dragover",Ue),Y(t,"drop",V),Y(t,"touchstart",I),Y(t,"touchmove",e[7]),Y(t,"touchend",p)],$=!0)},p(d,y){e=d,y&1&&r!==(r=e[19].title+"")&&Te(f,r),y&1&&u(t,"--book-color",e[19].color),y&1&&u(t,"--book-dark",ge(e[19].color)),y&1&&u(t,"--text-color",se(e[19].color).l>50?"#000":"#fff"),y&2&&h!==(h=!e[1])&&v(t,"draggable",h),y&1&&m!==(m=`${pe}: ${e[19].title}`)&&v(t,"aria-label",m),y&2&&E!==(E=!e[1])&&v(t,"aria-grabbed",E)},d(d){d&&_(t),$=!1,Ve(S)}}}function me(i){let e,t='<span class="text-accent animate-pulse">The books reveal their secret...</span>',l;return{c(){e=D("div"),e.innerHTML=t,this.h()},l(s){e=w(s,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1jfsuvx"&&(e.innerHTML=t),this.h()},h(){v(e,"class","success-message svelte-lty0mq")},m(s,a){B(s,e,a)},i(s){s&&(l||F(()=>{l=N(e,oe,{y:20,duration:800}),l.start()}))},o:P,d(s){s&&_(e)}}}function Fe(i){let e,t,l=[],s=new Map,a,n=ne(i[0]);const o=f=>f[19].id;for(let f=0;f<n.length;f+=1){let c=he(i,n,f),b=o(c);s.set(b,l[f]=ve(b,c))}let r=i[2]&&me();return{c(){e=D("div"),t=D("div");for(let f=0;f<l.length;f+=1)l[f].c();a=H(),r&&r.c(),this.h()},l(f){e=w(f,"DIV",{class:!0});var c=T(e);t=w(c,"DIV",{class:!0,role:!0,"aria-label":!0});var b=T(t);for(let k=0;k<l.length;k+=1)l[k].l(b);b.forEach(_),a=L(c),r&&r.l(c),c.forEach(_),this.h()},h(){v(t,"class","book-grid svelte-lty0mq"),v(t,"role","list"),v(t,"aria-label","Draggable book list"),v(e,"class","puzzle-board svelte-lty0mq"),ue(e,"disabled",i[1])},m(f,c){B(f,e,c),g(e,t);for(let b=0;b<l.length;b+=1)l[b]&&l[b].m(t,null);g(e,a),r&&r.m(e,null)},p(f,[c]){c&507&&(n=ne(f[0]),l=He(l,c,o,1,f,n,s,t,Se,ve,null,he)),f[2]?r?c&4&&q(r,1):(r=me(),r.c(),q(r,1),r.m(e,null)):r&&(r.d(1),r=null),c&2&&ue(e,"disabled",f[1])},i(f){q(r)},o:P,d(f){f&&_(e);for(let c=0;c<l.length;c+=1)l[c].d();r&&r.d()}}}const Ne="listitem",pe="Draggable book item";function Ue(i){i.preventDefault()}function se(i){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i);if(!e)return{h:0,s:0,l:0};const t=parseInt(e[1],16)/255,l=parseInt(e[2],16)/255,s=parseInt(e[3],16)/255,a=Math.max(t,l,s),n=Math.min(t,l,s),o=(a+n)/2;let r,f;if(a===n)r=f=0;else{const c=a-n;switch(f=o>.5?c/(2-a-n):c/(a+n),a){case t:r=(l-s)/c+(l<s?6:0);break;case l:r=(s-t)/c+2;break;case s:r=(t-l)/c+4;break;default:r=0}r/=6}return{h:Math.round(r*360),s:Math.round(f*100),l:Math.round(o*100)}}function ge(i){const e=se(i);return`hsl(${e.h}, ${e.s}%, ${Math.max(0,e.l-20)}%)`}function Ge(i,e,t){const l=je();let{books:s=[]}=e,{disabled:a=!1}=e,n=null,o=!1;Re(0,{duration:300,easing:re});let r=null;function f(p,d){a||(n=d,O.playEffect("book-drag.mp3",{volume:.3}),p.target instanceof HTMLElement&&(p.target.style.opacity="0.7",p.target.classList.add("dragging")))}function c(p){a||(n=null,p.target instanceof HTMLElement&&(p.target.style.opacity="1",p.target.classList.remove("dragging")))}function b(p,d){p.preventDefault(),!(a||n===null)&&E(n,d)}function k(p,d){a||(p.preventDefault(),r=d,O.playEffect("book-drag.mp3",{volume:.3}),p.target instanceof HTMLElement&&p.target.classList.add("touching"))}function h(p){a||r===null||p.preventDefault()}function m(p,d){a||r===null||(p.preventDefault(),p.target instanceof HTMLElement&&p.target.classList.remove("touching"),r!==d&&E(r,d),r=null)}function E(p,d){const y=s.findIndex(X=>X.id===p),z=s.findIndex(X=>X.id===d);if(y===-1||z===-1)return;const M=[...s];[M[y],M[z]]=[M[z],M[y]],t(0,s=M),O.playEffect("book-place.mp3",{volume:.4}),$()}function $(){[...s].every((d,y)=>{if(y===0)return!0;const z=se(d.color),M=se(s[y-1].color);return z.l>=M.l})&&!o&&(t(2,o=!0),l("solve"))}const S=(p,d)=>f(d,p.id),C=(p,d)=>b(d,p.id),V=(p,d)=>k(d,p.id),I=(p,d)=>m(d,p.id);return i.$$set=p=>{"books"in p&&t(0,s=p.books),"disabled"in p&&t(1,a=p.disabled)},[s,a,o,f,c,b,k,h,m,S,C,V,I]}class Ke extends x{constructor(e){super(),ee(this,e,Ge,Fe,W,{books:0,disabled:1})}}function be(i,e,t){const l=i.slice();return l[2]=e[t],l[4]=t,l}function _e(i,e){let t,l,s,a,n,o,r,f,c,b=e[2].title+"",k,h,m,E,$,S;return{key:i,first:null,c(){t=D("div"),l=D("div"),s=D("div"),a=H(),n=D("div"),o=D("div"),r=H(),f=D("div"),c=D("span"),k=$e(b),h=H(),m=D("div"),E=H(),$=D("div"),S=H(),this.h()},l(C){t=w(C,"DIV",{class:!0,style:!0});var V=T(t);l=w(V,"DIV",{class:!0});var I=T(l);s=w(I,"DIV",{class:!0}),T(s).forEach(_),a=L(I),n=w(I,"DIV",{class:!0,style:!0});var p=T(n);o=w(p,"DIV",{class:!0}),T(o).forEach(_),p.forEach(_),r=L(I),f=w(I,"DIV",{class:!0,style:!0});var d=T(f);c=w(d,"SPAN",{class:!0});var y=T(c);k=qe(y,b),y.forEach(_),d.forEach(_),h=L(I),m=w(I,"DIV",{class:!0,style:!0}),T(m).forEach(_),E=L(I),$=w(I,"DIV",{class:!0}),T($).forEach(_),I.forEach(_),S=L(V),V.forEach(_),this.h()},h(){v(s,"class","book-pages svelte-1us0k7j"),v(o,"class","spine-detail svelte-1us0k7j"),v(n,"class","book-spine svelte-1us0k7j"),u(n,"background-color",e[2].color),v(c,"class","book-title svelte-1us0k7j"),v(f,"class","book-cover front svelte-1us0k7j"),u(f,"background-color",e[2].color),v(m,"class","book-cover back svelte-1us0k7j"),u(m,"background-color",e[2].color),v($,"class","book-edge svelte-1us0k7j"),v(l,"class","book-model svelte-1us0k7j"),v(t,"class","flying-book svelte-1us0k7j"),u(t,"--start-x",e[1][e[4]].startX+"vw"),u(t,"--start-y",e[1][e[4]].startY+"vh"),u(t,"--start-z",e[1][e[4]].startZ+"px"),u(t,"--end-x",e[1][e[4]].endX+"vw"),u(t,"--end-y",e[1][e[4]].endY+"vh"),u(t,"--end-z",e[1][e[4]].endZ+"px"),u(t,"--book-scale",e[1][e[4]].scale),u(t,"--rotation-speed",e[1][e[4]].rotationSpeed+"s"),u(t,"--motion-duration",e[1][e[4]].duration+"s"),u(t,"--motion-delay",e[1][e[4]].delay+"s"),u(t,"--rotation-x",e[1][e[4]].rotationX+"deg"),u(t,"--rotation-z",e[1][e[4]].rotationZ+"deg"),u(t,"--page-color",e[1][e[4]].pageColor),u(t,"animation-duration","var(--motion-duration)"),u(t,"animation-delay","var(--motion-delay)"),this.first=t},m(C,V){B(C,t,V),g(t,l),g(l,s),g(l,a),g(l,n),g(n,o),g(l,r),g(l,f),g(f,c),g(c,k),g(l,h),g(l,m),g(l,E),g(l,$),g(t,S)},p(C,V){e=C,V&1&&u(n,"background-color",e[2].color),V&1&&b!==(b=e[2].title+"")&&Te(k,b),V&1&&u(f,"background-color",e[2].color),V&1&&u(m,"background-color",e[2].color),V&1&&u(t,"--start-x",e[1][e[4]].startX+"vw"),V&1&&u(t,"--start-y",e[1][e[4]].startY+"vh"),V&1&&u(t,"--start-z",e[1][e[4]].startZ+"px"),V&1&&u(t,"--end-x",e[1][e[4]].endX+"vw"),V&1&&u(t,"--end-y",e[1][e[4]].endY+"vh"),V&1&&u(t,"--end-z",e[1][e[4]].endZ+"px"),V&1&&u(t,"--book-scale",e[1][e[4]].scale),V&1&&u(t,"--rotation-speed",e[1][e[4]].rotationSpeed+"s"),V&1&&u(t,"--motion-duration",e[1][e[4]].duration+"s"),V&1&&u(t,"--motion-delay",e[1][e[4]].delay+"s"),V&1&&u(t,"--rotation-x",e[1][e[4]].rotationX+"deg"),V&1&&u(t,"--rotation-z",e[1][e[4]].rotationZ+"deg"),V&1&&u(t,"--page-color",e[1][e[4]].pageColor)},d(C){C&&_(t)}}}function Je(i){let e,t,l,s=[],a=new Map,n=ne(i[0]);const o=r=>r[2].id;for(let r=0;r<n.length;r+=1){let f=be(i,n,r),c=o(f);a.set(c,s[r]=_e(c,f))}return{c(){e=D("div"),t=D("div"),l=H();for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=w(r,"DIV",{class:!0,"aria-hidden":!0});var f=T(e);t=w(f,"DIV",{class:!0}),T(t).forEach(_),l=L(f);for(let c=0;c<s.length;c+=1)s[c].l(f);f.forEach(_),this.h()},h(){v(t,"class","dust-particles svelte-1us0k7j"),v(e,"class","book-space svelte-1us0k7j"),v(e,"aria-hidden","true")},m(r,f){B(r,e,f),g(e,t),g(e,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null)},p(r,[f]){f&3&&(n=ne(r[0]),s=He(s,f,o,1,r,n,a,e,Se,_e,null,be))},i:P,o:P,d(r){r&&_(e);for(let f=0;f<s.length;f+=1)s[f].d()}}}function Qe(i,e,t){let{books:l=[]}=e;const s=l.map(()=>{const a=Math.random()*100,n=Math.random()*100;let o=Math.random()*100,r=Math.random()*100;for(;Math.abs(o-a)<50&&Math.abs(r-n)<50;)o=Math.random()*100,r=Math.random()*100;return{startX:a,startY:n,endX:o,endY:r,startZ:-50+Math.random()*100,endZ:-50+Math.random()*100,scale:.4+Math.random()*.3,rotationSpeed:15+Math.random()*25,duration:15+Math.random()*30,delay:Math.random()*10,rotationX:Math.random()*20-10,rotationZ:Math.random()*20-10,pageColor:`hsl(${30+Math.random()*20}, ${70+Math.random()*20}%, ${80+Math.random()*15}%)`}});return i.$$set=a=>{"books"in a&&t(0,l=a.books)},[l,s]}class We extends x{constructor(e){super(),ee(this,e,Qe,Je,W,{books:0})}}function ke(i){let e,t,l='<div class="glow-effect svelte-1luqfw"></div> <h3 class="text-3xl text-accent mb-4">Hidden Knowledge Revealed</h3> <div class="parchment svelte-1luqfw"><img src="https://kxmwcpeuiklblpehddkz.supabase.co/storage/v1/object/public/clues//library%20ancient%20manuscript.jpeg" alt="Ancient manuscript page" class="manuscript-page svelte-1luqfw"/> <div class="page-text svelte-1luqfw">A detailed study of toxic flora, with particular attention to their use in Victorian gardens...</div></div>',s,a;return{c(){e=D("div"),t=D("div"),t.innerHTML=l,this.h()},l(n){e=w(n,"DIV",{class:!0});var o=T(e);t=w(o,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-b73r4m"&&(t.innerHTML=l),o.forEach(_),this.h()},h(){v(t,"class","content-wrapper svelte-1luqfw"),v(e,"class","compartment-content svelte-1luqfw")},m(n,o){B(n,e,o),g(e,t)},i(n){n&&(s||F(()=>{s=N(t,oe,{y:50,delay:1500,duration:1e3,easing:re}),s.start()})),n&&(a||F(()=>{a=N(e,Q,{delay:1200,duration:800}),a.start()}))},o:P,d(n){n&&_(e)}}}function xe(i){let e,t,l,s='<div class="door-face front svelte-1luqfw"></div> <div class="door-face back svelte-1luqfw"></div> <div class="door-edge svelte-1luqfw"></div>',a,n,o=i[0]&&ke();return{c(){e=D("div"),t=D("div"),l=D("div"),l.innerHTML=s,a=H(),o&&o.c(),this.h()},l(r){e=w(r,"DIV",{class:!0});var f=T(e);t=w(f,"DIV",{class:!0});var c=T(t);l=w(c,"DIV",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-am8ts2"&&(l.innerHTML=s),a=L(c),o&&o.l(c),c.forEach(_),f.forEach(_),this.h()},h(){v(l,"class","compartment-door svelte-1luqfw"),v(t,"class","compartment-frame svelte-1luqfw"),v(e,"class",n="secret-compartment "+(i[0]?"revealed":"")+" svelte-1luqfw")},m(r,f){B(r,e,f),g(e,t),g(t,l),g(t,a),o&&o.m(t,null),i[2](e)},p(r,[f]){r[0]?o?f&1&&q(o,1):(o=ke(),o.c(),q(o,1),o.m(t,null)):o&&(o.d(1),o=null),f&1&&n!==(n="secret-compartment "+(r[0]?"revealed":"")+" svelte-1luqfw")&&v(e,"class",n)},i(r){q(o)},o:P,d(r){r&&_(e),o&&o.d(),i[2](null)}}}function et(i,e,t){let{revealed:l=!1}=e,s;function a(n){Le[n?"unshift":"push"](()=>{s=n,t(1,s)})}return i.$$set=n=>{"revealed"in n&&t(0,l=n.revealed)},i.$$.update=()=>{i.$$.dirty&3&&l&&s&&(O.playEffect("compartment-open.mp3",{volume:.6}),setTimeout(()=>{O.playEffect("paper-rustle.mp3",{volume:.4})},1500))},[l,s,a]}class tt extends x{constructor(e){super(),ee(this,e,et,xe,W,{revealed:0})}}function lt(i){let e,t,l,s,a='<div class="candle-light svelte-1lcissr"></div> <div class="ambient-glow svelte-1lcissr"></div>';return{c(){e=D("div"),t=D("div"),l=H(),s=D("div"),s.innerHTML=a,this.h()},l(n){e=w(n,"DIV",{class:!0});var o=T(e);t=w(o,"DIV",{class:!0,style:!0}),T(t).forEach(_),l=L(o),s=w(o,"DIV",{class:!0,"data-svelte-h":!0}),R(s)!=="svelte-bw29di"&&(s.innerHTML=a),o.forEach(_),this.h()},h(){v(t,"class","grain-overlay svelte-1lcissr"),u(t,"--grain-intensity",i[0]),u(t,"--flicker-speed",i[1]+"s"),v(s,"class","lighting-effects svelte-1lcissr"),v(e,"class","visual-effects svelte-1lcissr")},m(n,o){B(n,e,o),g(e,t),g(e,l),g(e,s)},p(n,[o]){o&1&&u(t,"--grain-intensity",n[0]),o&2&&u(t,"--flicker-speed",n[1]+"s")},i:P,o:P,d(n){n&&_(e)}}}function st(i,e,t){let{intensity:l=.15}=e,{flickerSpeed:s=.2}=e;return i.$$set=a=>{"intensity"in a&&t(0,l=a.intensity),"flickerSpeed"in a&&t(1,s=a.flickerSpeed)},[l,s]}class nt extends x{constructor(e){super(),ee(this,e,st,lt,W,{intensity:0,flickerSpeed:1})}}function at(i){let e,t,l='<div class="wax svelte-1b8z4yq"></div> <div class="wick svelte-1b8z4yq"></div> <div class="flame svelte-1b8z4yq"><div class="flame-core svelte-1b8z4yq"></div> <div class="flame-outer svelte-1b8z4yq"></div> <div class="glow svelte-1b8z4yq"></div></div>',s;return{c(){e=D("div"),t=D("div"),t.innerHTML=l,this.h()},l(a){e=w(a,"DIV",{class:!0,style:!0});var n=T(e);t=w(n,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-9j5vlj"&&(t.innerHTML=l),n.forEach(_),this.h()},h(){v(t,"class","candle-body svelte-1b8z4yq"),v(e,"class",s="candle "+i[0]+" svelte-1b8z4yq"),u(e,"left",i[1].x+"%"),u(e,"top",i[1].y+"%"),u(e,"--intensity",i[2])},m(a,n){B(a,e,n),g(e,t)},p(a,[n]){n&1&&s!==(s="candle "+a[0]+" svelte-1b8z4yq")&&v(e,"class",s),n&2&&u(e,"left",a[1].x+"%"),n&2&&u(e,"top",a[1].y+"%"),n&4&&u(e,"--intensity",a[2])},i:P,o:P,d(a){a&&_(e)}}}function it(i,e,t){let{size:l="medium"}=e,{position:s={x:50,y:50}}=e,{intensity:a=1}=e;return i.$$set=n=>{"size"in n&&t(0,l=n.size),"position"in n&&t(1,s=n.position),"intensity"in n&&t(2,a=n.intensity)},[l,s,a]}class ae extends x{constructor(e){super(),ee(this,e,it,at,W,{size:0,position:1,intensity:2})}}function ye(i){let e,t;return e=new We({props:{books:i[8]}}),{c(){J(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p:P,i(l){t||(q(e.$$.fragment,l),t=!0)},o(l){A(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Ee(i){let e;return{c(){e=D("div"),this.h()},l(t){e=w(t,"DIV",{class:!0,style:!0}),T(e).forEach(_),this.h()},h(){v(e,"class","touch-feedback svelte-1l1tmgf"),u(e,"left",i[5].x+"%"),u(e,"top",i[5].y+"%"),u(e,"opacity",i[4]>.3?.7:.4),u(e,"transform","scale("+(1+i[4])+")")},m(t,l){B(t,e,l)},p(t,l){l&32&&u(e,"left",t[5].x+"%"),l&32&&u(e,"top",t[5].y+"%"),l&16&&u(e,"opacity",t[4]>.3?.7:.4),l&16&&u(e,"transform","scale("+(1+t[4])+")")},d(t){t&&_(e)}}}function we(i){let e,t,l,s,a,n,o,r;const f=[ot,rt],c=[];function b(h,m){return h[0]?1:0}l=b(i),s=c[l]=f[l](i);let k=i[1]&&Me();return{c(){e=D("main"),t=D("div"),s.c(),a=H(),k&&k.c(),this.h()},l(h){e=w(h,"MAIN",{class:!0});var m=T(e);t=w(m,"DIV",{class:!0});var E=T(t);s.l(E),a=L(E),k&&k.l(E),E.forEach(_),m.forEach(_),this.h()},h(){v(t,"class",n="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(i[1]?"solved":"")+" svelte-1l1tmgf"),v(e,"class","relative z-20 max-w-6xl mx-auto px-4 py-4 md:py-12 min-h-screen flex items-center justify-center")},m(h,m){B(h,e,m),g(e,t),c[l].m(t,null),g(t,a),k&&k.m(t,null),r=!0},p(h,m){let E=l;l=b(h),l===E?c[l].p(h,m):(le(),A(c[E],1,1,()=>{c[E]=null}),te(),s=c[l],s?s.p(h,m):(s=c[l]=f[l](h),s.c()),q(s,1),s.m(t,a)),h[1]?k?m&2&&q(k,1):(k=Me(),k.c(),q(k,1),k.m(t,null)):k&&(le(),A(k,1,1,()=>{k=null}),te()),(!r||m&2&&n!==(n="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(h[1]?"solved":"")+" svelte-1l1tmgf"))&&v(t,"class",n)},i(h){r||(q(s),q(k),h&&(o||F(()=>{o=N(e,Q,{duration:1e3,delay:300}),o.start()})),r=!0)},o(h){A(s),A(k),r=!1},d(h){h&&_(e),c[l].d(),k&&k.d()}}}function rt(i){let e,t,l,s;return t=new Ke({props:{books:i[8],disabled:i[1]}}),t.$on("solve",i[9]),{c(){e=D("div"),J(t.$$.fragment),this.h()},l(a){e=w(a,"DIV",{class:!0});var n=T(e);K(t.$$.fragment,n),n.forEach(_),this.h()},h(){v(e,"class","puzzle-wrapper svelte-1l1tmgf")},m(a,n){B(a,e,n),G(t,e,null),s=!0},p(a,n){const o={};n&2&&(o.disabled=a[1]),t.$set(o)},i(a){s||(q(t.$$.fragment,a),a&&(l||F(()=>{l=N(e,Q,{duration:800}),l.start()})),s=!0)},o(a){A(t.$$.fragment,a),s=!1},d(a){a&&_(e),U(t)}}}function ot(i){let e,t,l,s,a,n,o="A peculiar arrangement of books catches your eye...",r,f,c,b,k,h=i[4]>.5&&i[4]<.8&&De();return{c(){e=D("div"),t=D("div"),l=D("div"),s=H(),a=D("div"),n=D("span"),n.textContent=o,r=H(),h&&h.c(),this.h()},l(m){e=w(m,"DIV",{class:!0});var E=T(e);t=w(E,"DIV",{class:!0,role:!0,"aria-label":!0,tabindex:!0});var $=T(t);l=w($,"DIV",{class:!0,style:!0}),T(l).forEach(_),s=L($),a=w($,"DIV",{class:!0,style:!0});var S=T(a);n=w(S,"SPAN",{class:!0,"data-svelte-h":!0}),R(n)!=="svelte-1bbeums"&&(n.textContent=o),S.forEach(_),r=L($),h&&h.l($),$.forEach(_),E.forEach(_),this.h()},h(){v(l,"class","bookshelf-highlight svelte-1l1tmgf"),u(l,"opacity",i[4]>.3?i[4]:0),v(n,"class","hint-text svelte-1l1tmgf"),v(a,"class","bookshelf-hint svelte-1l1tmgf"),u(a,"opacity",i[3]?1:0),u(a,"transform","translateY("+(i[3]?0:10)+"px)"),v(t,"class",f="bookshelf-area "+(i[3]?"hovered":"")+" svelte-1l1tmgf"),v(t,"role","button"),v(t,"aria-label","Interact with the bookshelf"),v(t,"tabindex","0"),v(e,"class","bookshelf-interactive svelte-1l1tmgf")},m(m,E){B(m,e,E),g(e,t),g(t,l),g(t,s),g(t,a),g(a,n),g(t,r),h&&h.m(t,null),b||(k=[Y(t,"click",i[10]),Y(t,"mouseenter",i[11]),Y(t,"mouseleave",i[12]),Y(t,"keydown",i[13])],b=!0)},p(m,E){E&16&&u(l,"opacity",m[4]>.3?m[4]:0),E&8&&u(a,"opacity",m[3]?1:0),E&8&&u(a,"transform","translateY("+(m[3]?0:10)+"px)"),m[4]>.5&&m[4]<.8?h?E&16&&q(h,1):(h=De(),h.c(),q(h,1),h.m(t,null)):h&&(h.d(1),h=null),E&8&&f!==(f="bookshelf-area "+(m[3]?"hovered":"")+" svelte-1l1tmgf")&&v(t,"class",f)},i(m){q(h),m&&(c||F(()=>{c=N(e,Q,{duration:500}),c.start()}))},o:P,d(m){m&&_(e),h&&h.d(),b=!1,Ve(k)}}}function De(i){let e,t="<span>Hold to examine...</span>",l;return{c(){e=D("div"),e.innerHTML=t,this.h()},l(s){e=w(s,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-zyjqha"&&(e.innerHTML=t),this.h()},h(){v(e,"class","mobile-hint svelte-1l1tmgf")},m(s,a){B(s,e,a)},i(s){s&&(l||F(()=>{l=N(e,Q,{duration:300}),l.start()}))},o:P,d(s){s&&_(e)}}}function Me(i){let e,t,l,s;return t=new tt({props:{revealed:!0}}),{c(){e=D("div"),J(t.$$.fragment),this.h()},l(a){e=w(a,"DIV",{class:!0});var n=T(e);K(t.$$.fragment,n),n.forEach(_),this.h()},h(){v(e,"class","mt-8")},m(a,n){B(a,e,n),G(t,e,null),s=!0},i(a){s||(q(t.$$.fragment,a),a&&(l||F(()=>{l=N(e,oe,{y:20,duration:800}),l.start()})),s=!0)},o(a){A(t.$$.fragment,a),s=!1},d(a){a&&_(e),U(t)}}}function ze(i){let e,t='<div class="tutorial-content svelte-1l1tmgf"><span>Explore the library by touching different areas...</span></div>',l,s,a;return{c(){e=D("div"),e.innerHTML=t,this.h()},l(n){e=w(n,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-gegkjq"&&(e.innerHTML=t),this.h()},h(){v(e,"class","mobile-tutorial svelte-1l1tmgf")},m(n,o){B(n,e,o),a=!0},i(n){a||(n&&F(()=>{a&&(s&&s.end(1),l=N(e,Q,{duration:800,delay:1500}),l.start())}),a=!0)},o(n){l&&l.invalidate(),n&&(s=Oe(e,Q,{duration:500})),a=!1},d(n){n&&_(e),n&&s&&s.end()}}}function ft(i){let e,t,l,s,a,n,o='<a href="/" class="text-parchment hover:text-accent transition-colors duration-300 text-lg">← Return Home</a>',r,f,c,b,k,h,m,E,$,S,C,V;s=new nt({props:{intensity:i[1]?.18:.12,flickerSpeed:.15}}),f=new ae({props:{size:"large",position:{x:50,y:20},intensity:i[1]?1.2:1}}),b=new ae({props:{size:"medium",position:{x:15,y:40}}}),h=new ae({props:{size:"medium",position:{x:85,y:40}}});let I=!i[0]&&ye(i),p=i[6]&&Ee(i),d=i[2]&&we(i),y=i[2]&&!i[0]&&ze();return{c(){e=D("div"),t=D("div"),l=H(),J(s.$$.fragment),a=H(),n=D("div"),n.innerHTML=o,r=H(),J(f.$$.fragment),c=H(),J(b.$$.fragment),k=H(),J(h.$$.fragment),m=H(),E=D("div"),I&&I.c(),$=H(),p&&p.c(),S=H(),d&&d.c(),C=H(),y&&y.c(),this.h()},l(z){e=w(z,"DIV",{class:!0,style:!0});var M=T(e);t=w(M,"DIV",{class:!0}),T(t).forEach(_),l=L(M),K(s.$$.fragment,M),a=L(M),n=w(M,"DIV",{class:!0,"data-svelte-h":!0}),R(n)!=="svelte-kgi9zb"&&(n.innerHTML=o),r=L(M),K(f.$$.fragment,M),c=L(M),K(b.$$.fragment,M),k=L(M),K(h.$$.fragment,M),m=L(M),E=w(M,"DIV",{class:!0});var X=T(E);I&&I.l(X),X.forEach(_),$=L(M),p&&p.l(M),S=L(M),d&&d.l(M),C=L(M),y&&y.l(M),M.forEach(_),this.h()},h(){v(t,"class","absolute inset-0 bg-black/50 z-0"),v(n,"class","absolute bottom-8 left-8 z-50"),v(E,"class","absolute inset-0 z-10"),v(e,"class","library-container min-h-screen overflow-hidden relative svelte-1l1tmgf"),u(e,"background-image","url("+ct+")"),u(e,"background-size","cover"),u(e,"background-position","center")},m(z,M){B(z,e,M),g(e,t),g(e,l),G(s,e,null),g(e,a),g(e,n),g(e,r),G(f,e,null),g(e,c),G(b,e,null),g(e,k),G(h,e,null),g(e,m),g(e,E),I&&I.m(E,null),g(e,$),p&&p.m(e,null),g(e,S),d&&d.m(e,null),g(e,C),y&&y.m(e,null),i[14](e),V=!0},p(z,[M]){const X={};M&2&&(X.intensity=z[1]?.18:.12),s.$set(X);const j={};M&2&&(j.intensity=z[1]?1.2:1),f.$set(j),z[0]?I&&(le(),A(I,1,1,()=>{I=null}),te()):I?(I.p(z,M),M&1&&q(I,1)):(I=ye(z),I.c(),q(I,1),I.m(E,null)),z[6]?p?p.p(z,M):(p=Ee(z),p.c(),p.m(e,S)):p&&(p.d(1),p=null),z[2]?d?(d.p(z,M),M&4&&q(d,1)):(d=we(z),d.c(),q(d,1),d.m(e,C)):d&&(le(),A(d,1,1,()=>{d=null}),te()),z[2]&&!z[0]?y?M&5&&q(y,1):(y=ze(),y.c(),q(y,1),y.m(e,null)):y&&(le(),A(y,1,1,()=>{y=null}),te())},i(z){V||(q(s.$$.fragment,z),q(f.$$.fragment,z),q(b.$$.fragment,z),q(h.$$.fragment,z),q(I),q(d),q(y),V=!0)},o(z){A(s.$$.fragment,z),A(f.$$.fragment,z),A(b.$$.fragment,z),A(h.$$.fragment,z),A(I),A(d),A(y),V=!1},d(z){z&&_(e),U(s),U(f),U(b),U(h),I&&I.d(),p&&p.d(),d&&d.d(),y&&y.d(),i[14](null)}}}const ct="https://kxmwcpeuiklblpehddkz.supabase.co/storage/v1/object/public/suspects//library.jpeg";function ut(i,e,t,l){return Math.sqrt(Math.pow(t-i,2)+Math.pow(l-e,2))}function dt(i,e,t){let l=!1,s=!1,a=!1,n=!1,o=!1,r=0;const f=[{id:1,title:"Mortiferous Mushrooms",color:"#8C0000"},{id:2,title:"Aconitum Anthology",color:"#2A003C"},{id:3,title:"Venomous Flora",color:"#39FF14"},{id:4,title:"Dark Rituals",color:"#0A0004"}],c={x:50,y:40,radius:20};let b=0,k={x:0,y:0},h=!1,m;Ce(()=>{O.playAmbient("library-ambience.mp3",{volume:.3,fade:!0,fadeIn:3e3}),setTimeout(()=>t(2,a=!0),100),E()}),Ae(()=>{O.stopAmbient("library-ambience.mp3",{fade:!0,fadeOut:2e3})});function E(){m&&(m.addEventListener("touchstart",$),m.addEventListener("touchmove",S),m.addEventListener("touchend",C))}function $(j){if(l)return;b=Date.now();const Z=j.touches[0];V(Z),t(6,h=!0),I()}function S(j){if(l)return;const Z=j.touches[0];V(Z),I()}function C(j){if(l)return;const Z=Date.now()-b;t(6,h=!1),Z>300&&r>.7&&d()}function V(j){const Z=m.getBoundingClientRect();t(5,k={x:(j.clientX-Z.left)/Z.width*100,y:(j.clientY-Z.top)/Z.height*100})}function I(){const j=ut(k.x,k.y,c.x,c.y);t(4,r=Math.max(0,1-j/c.radius)),t(3,n=r>.3),r>.7&&navigator.vibrate&&navigator.vibrate(Math.floor(r*30)),r>.5&&!o?(o=!0,O.playEffect("creak.mp3",{volume:r*.3})):r<.3&&(o=!1)}async function p(){t(1,s=!0),O.playEffect("puzzle-solve.mp3",{volume:.5}),Xe.update(j=>[...j,{id:"book-puzzle",description:"The arrangement reveals a hidden message about poisonous plants...",discovered_at:new Date().toISOString(),image:"/images/clues/poisoned-page.png"}]),O.playEffect("secret-reveal.mp3",{volume:.4,fade:!0,fadeIn:1e3})}function d(){l||(t(0,l=!0),O.playEffect("bookshelf-creak.mp3",{volume:.4}))}function y(){!l&&!n&&(t(3,n=!0),O.playEffect("creak.mp3",{volume:.2}))}const z=()=>t(3,n=!1),M=j=>j.key==="Enter"&&d();function X(j){Le[j?"unshift":"push"](()=>{m=j,t(7,m)})}return[l,s,a,n,r,k,h,m,f,p,d,y,z,M,X]}class _t extends x{constructor(e){super(),ee(this,e,dt,ft,W,{})}}export{_t as component,bt as universal};
